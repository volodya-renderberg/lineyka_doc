.. _commit-push-publish-page:

Commit Push Publish specification
=================================

Все экшены пишутся в один лог :ref:`class-log-page`.

Commit
------

Cоздание локальной версии.

* место хранения ``work`` директория, определяется в *set studio*, метод ``studio.set_work_dir()``

Push
----

Создание версии на сервере.

* операция не создаёт новый *commit*
* для *sketch* - сразу создавать *png*
* загружается последняя или кастомная версия указанной ветки из *work*
* проверка на совпадение с последней *push* версией по атрибуту ``source``
* место хранения в ``project/assets``
* нумерация отличается от локальных
	* **sketch:**
		* один номер на все ветки, как бы пачка одной версии
* атрибут ``source`` - локальная версия откуда был *push*
	* **sketch:**
		* в *source* - для каждой ветки свой номер версии, откуда был *push*
* *branch* - соответствует локальному

Publish
-------

Публикация финальной версии на сервере.

* последняя или по выбору *push* версия
* атрибут ``source`` - номер *push* версии
* атрибут ``branch`` - записывается из *push*
* самостоятельное выполнение, не связанное с приёмом задачи.
* приёмка задачи не запускает *publish*

Файловая структура:
*******************

* Сверху файлы последней версии:
    * **asset_name#branch_name.ext**
    * **asset_name#branch_name.png** (для *sketch*) 
* Директории:
    * **version_num** - содержат весь набор файлов версии.
